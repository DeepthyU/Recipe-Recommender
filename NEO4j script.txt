LOAD CSV WITH HEADERS  FROM "file:///recipes.csv" AS line  
CREATE 
(p:recipe{recipeid:line.recipeid,name:line.name,description:line.description,method:line.method,recipe_url:line.recipe_url})

LOAD CSV WITH HEADERS  FROM "file:///ingredients.csv" AS line  
CREATE 
(p:ingredient{ingredientid:line.ingredientid,recipename:line.name,content:line.ingredients})

MATCH (a:recipe), (b:ingredient)
WHERE a.name=b.recipename 
CREATE (a)-[: HAS_INGREDIENT]->(b) 

CREATE (v:value {name:'calories'}) 
CREATE (v:value {name:'fat'})
CREATE (v:value {name:'saturates'})
CREATE (v:value {name:'carbs'})
CREATE (v:value {name:'sugars'})
CREATE (v:value {name:'fibre'})
CREATE (v:value {name:'protein'})
CREATE (v:value {name:'salt'})

LOAD CSV WITH HEADERS  FROM "file:///values.csv" AS line  
MATCH  (a:recipe),(b:value)
WHERE b.name='calories' and a.name=line.name
CREATE (a)-[:HAS_NUTRITIONAL_VALUE{amount: line.kcal}]->(b)

LOAD CSV WITH HEADERS  FROM "file:///values.csv" AS line  
MATCH  (a:recipe),(b:value)
WHERE b.name='fat' and a.name=line.name
CREATE (a)-[:HAS_NUTRITIONAL_VALUE{amount: line.fat}]->(b)

LOAD CSV WITH HEADERS  FROM "file:///values.csv" AS line  
MATCH  (a:recipe),(b:value)
WHERE b.name='saturates' and a.name=line.name
CREATE (a)-[:HAS_NUTRITIONAL_VALUE{amount: line.saturates}]->(b)

LOAD CSV WITH HEADERS  FROM "file:///values.csv" AS line  
MATCH  (a:recipe),(b:value)
WHERE b.name='carbs' and a.name=line.name
CREATE (a)-[:HAS_NUTRITIONAL_VALUE{amount: line.carbs}]->(b)

LOAD CSV WITH HEADERS  FROM "file:///values.csv" AS line  
MATCH  (a:recipe),(b:value)
WHERE b.name='sugars' and a.name=line.name
CREATE (a)-[:HAS_NUTRITIONAL_VALUE{amount: line.sugars}]->(b)

LOAD CSV WITH HEADERS  FROM "file:///values.csv" AS line  
MATCH  (a:recipe),(b:value)
WHERE b.name='fibre' and a.name=line.name
CREATE (a)-[:HAS_NUTRITIONAL_VALUE{amount: line.fibre}]->(b)

LOAD CSV WITH HEADERS  FROM "file:///values.csv" AS line  
MATCH  (a:recipe),(b:value)
WHERE b.name='protein' and a.name=line.name
CREATE (a)-[:HAS_NUTRITIONAL_VALUE{amount: line.protein}]->(b)